---
title: "Examples for ddst package"
author: "Przemyslaw Biecek"
date: "July 26, 2019"
output: 
  html_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Data Driven Smooth Tests with ddst package

This document presents tests avaliable in the `ddst` package.

```{r, warning=FALSE, message=FALSE}
library("ddst")
```

# II. Data driven smooth tests for selected goodness-of-fit problems

```{r}
```

## 1. Data Driven Smooth Test for Uniformity

```{r}
z <- c(13.41, 6.04, 1.26, 3.67, -4.54, 2.92, 0.44, 12.93, 6.77, 10.09,
       4.10, 4.04, -1.97, 2.17, -5.38, -7.30, 4.75, 5.63, 8.84)
ddst.uniform.test(z, compute.p = TRUE)

# when H0 is true
z <- runif(80)
ddst.uniform.test(z, compute.p = TRUE)

# for known fixed alternative, here N(10,16)
z <- pnorm(z, 10, 16)
ddst.uniform.test(z, compute.p = TRUE)

# when H0 is false
z <- rbeta(80,4,2)
ddst.uniform.test(z, compute.p = TRUE)

# just p-value
ddst.uniform.test(z, compute.p = TRUE)$p.value
```
## 2. Data Driven Smooth Test for Exponentiality

```{r}
# for given vector of 19 numbers
z <- c(13.41, 6.04, 1.26, 3.67, -4.54, 2.92, 0.44, 12.93, 6.77, 10.09,
       4.10, 4.04, -1.97, 2.17, -5.38, -7.30, 4.75, 5.63, 8.84)
ddst.exp.test(z, compute.p = TRUE)

# when H0 is true
z <- rexp(80, 4)
ddst.exp.test(z, compute.p = TRUE)

# when H0 is false
z <- rchisq(80, 4)
ddst.exp.test(z, compute.p = TRUE)

```

## 3. Data Driven Smooth Tests for Normality


### 3.1. The case of bounded basis functions

```{r}
# for given vector of 19 numbers
z <- c(13.41, 6.04, 1.26, 3.67, -4.54, 2.92, 0.44, 12.93, 6.77, 10.09,
      4.10, 4.04, -1.97, 2.17, -5.38, -7.30, 4.75, 5.63, 8.84)
ddst.norm.test(z, compute.p = TRUE)

# when H0 is true
z <- rnorm(80)
ddst.norm.test(z, compute.p = TRUE)

# when H0 is false
z = rexp(80, 4)
ddst.norm.test(z, B = 5000, compute.p = TRUE)

```

### 3.2. The case of unbounded basis functions



## 4. Data Driven Smooth Test for Extreme Value Distribution


```{r}
# for given vector of 19 numbers
z <- c(13.41, 6.04, 1.26, 3.67, -4.54, 2.92, 0.44, 12.93, 6.77, 10.09,
      4.10, 4.04, -1.97, 2.17, -5.38, -7.30, 4.75, 5.63, 8.84)
ddst.extr.test(z, compute.p = TRUE)

library(evd)
z <- -qgumbel(runif(100), -1, 1)
ddst.extr.test(z, compute.p = TRUE)

# when H0 is false
z <- rexp(80, 4)
ddst.extr.test(z, compute.p = TRUE)

```

# III. Nonparametric Data Driven Smooth Tests for Comparing Distributions


## 5. Data Driven Smooth Test for k-Sample Problem

```{r}
# H0 is true
x = runif(80)
y = runif(80)
z = runif(80)
t <- ddst.ksample.test(x, y, z)
t
plot(t)

# known fixed alternative
x = runif(80)
y = rbeta(80,4,2)
w = rnorm(30)
z = rexp(10, 1)
t <- ddst.ksample.test(x, y, w, z)
t
plot(t)
```

## 6. Data Driven Smooth Test for Stochastic Dominance in Two Samples

```{r}
set.seed(13)
library("rmutil", warn.conflicts = FALSE)
# 1. Pareto(1)/Pareto(1.5)
x <- rpareto(50, 2, 2)
y <- rpareto(50, 1.5, 1.5)
t <- ddst.stochasticorder.test(x, y)
t
plot(t)

# 2. Laplace(0,1)/Laplace(1,25)
x <- rlaplace(50, 0, 1)
y <- rlaplace(50, 1, 25)
t <- ddst.stochasticorder.test(x, y)
t
plot(t)

# 3. LN(0.85,0.6)/LN(1.2,0.2)
x <- rlnorm(50, 0.85, 0.6)
y <- rlnorm(50, 1.2, 0.2)
t <- ddst.stochasticorder.test(x, y)
t
plot(t)
```

## 7. Two-Sample Test Against Stochastic Dominance

```{r, warning=FALSE, message=FALSE}
# H0 is true
x <- runif(80)
y <- runif(80)
t <- ddst.stochasticdominance.test(x, y)
t
plot(t)

# known fixed alternative
x <- runif(80)
y <- rbeta(80,4,2)
t <- ddst.stochasticdominance.test(x, y)
t
plot(t)
```

## 8. Data Driven Smooth Test for Upward Trend Alternative in k samples

```{r}
# H0 is true
x = runif(80)
y = runif(80) + 0.2
z = runif(80) + 0.4
t <- ddst.upward.test(list(x, y, z))
t
plot(t)

# known fixed alternative
x1 = rnorm(80)
x2 = rnorm(80) + 2
x3 = rnorm(80) + 4
x4 = rnorm(80) + 3
t <- ddst.upward.test(list(x1, x2, x3, x4))
t
plot(t)
```

## 9. Data Driven Smooth Test for Umbrella Alternatives in k samples

```{r}
# H0 is true
x = runif(80)
y = runif(80)
z = runif(80)
t <- ddst.umbrella.test(x, y, z)
t
plot(t)

# known fixed alternative
x = runif(80)
y = rbeta(80,4,2)
w = rnorm(30)
z = rexp(10, 1)
t <- ddst.umbrella.test(x, y, w, z)
t
plot(t)
```

## 10. Data Driven Smooth Test for Change-Point Problem


